<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Game Backlog Manager</title>
    <style>
        /* --- –°–¢–ò–õ–Ü (CSS) --- */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #1e1e1e;
            color: #f0f0f0;
            margin: 0;
            display: flex;
            justify-content: center;
            min-height: 100vh;
        }

        .container {
            width: 100%;
            max-width: 800px;
            padding: 20px;
        }

        h1 { text-align: center; color: #00ff99; margin-bottom: 30px; }

        /* –ö–Ω–æ–ø–∫–∏ */
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            transition: 0.2s;
            margin: 5px;
        }
        .btn-primary { background-color: #007acc; color: white; }
        .btn-success { background-color: #00ff99; color: black; }
        .btn-danger { background-color: #ff4d4d; color: white; }
        .btn-secondary { background-color: #555; color: white; }
        .btn:hover { opacity: 0.8; }

        /* –ú–µ–Ω—é */
        #menu-screen {
            display: flex;
            flex-direction: column;
            gap: 15px;
            align-items: center;
        }
        .menu-btn {
            width: 100%;
            max-width: 300px;
            padding: 20px;
            font-size: 18px;
        }

        /* –°–ø–∏—Å–æ–∫ —ñ–≥–æ—Ä */
        .game-card {
            background-color: #2d2d2d;
            border-left: 5px solid #00ff99;
            padding: 15px;
            margin-bottom: 15px;
            border-radius: 5px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .game-info h3 { margin: 0 0 5px 0; }
        .game-info p { margin: 2px 0; color: #aaa; font-size: 14px; }
        .status-badge {
            background-color: #444;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 12px;
            color: #fff;
        }

        /* –§–æ—Ä–º–∞ */
        .form-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 5px; }
        input, select, textarea {
            width: 100%;
            padding: 10px;
            background-color: #333;
            border: 1px solid #555;
            color: white;
            border-radius: 4px;
            box-sizing: border-box; /* –©–æ–± padding –Ω–µ –ª–∞–º–∞–≤ —à–∏—Ä–∏–Ω—É */
        }

        /* –ü—Ä–∏—Ö–æ–≤—É–≤–∞–Ω–Ω—è –±–ª–æ–∫—ñ–≤ */
        .screen { display: none; }
        .active { display: block; }

    </style>
</head>
<body>

    <div class="container">
        <h1>üéÆ Game Backlog</h1>

        <div id="menu-screen" class="screen active">
            <button class="btn btn-primary menu-btn" onclick="showLibrary()">üìö –ú–æ—è –ë—ñ–±–ª—ñ–æ—Ç–µ–∫–∞</button>
            <button class="btn btn-success menu-btn" onclick="showAddForm()">‚ûï –î–æ–¥–∞—Ç–∏ –ì—Ä—É</button>
        </div>

        <div id="library-screen" class="screen">
            <button class="btn btn-secondary" onclick="showMenu()">‚¨Ö –ù–∞–∑–∞–¥ –≤ –º–µ–Ω—é</button>
            <button class="btn btn-success" onclick="showAddForm()" style="float: right;">+ –î–æ–¥–∞—Ç–∏</button>
            <h2 style="border-bottom: 1px solid #444; padding-bottom: 10px;">–°–ø–∏—Å–æ–∫ —ñ–≥–æ—Ä</h2>
            <div id="games-list">Loading...</div>
        </div>

        <div id="form-screen" class="screen">
            <h2 id="form-title">–î–æ–¥–∞—Ç–∏ –Ω–æ–≤—É –≥—Ä—É</h2>
            <input type="hidden" id="game-id"> <div class="form-group">
                <label>–ù–∞–∑–≤–∞ –≥—Ä–∏:</label>
                <input type="text" id="title" placeholder="Witcher 3">
            </div>
            <div class="form-group">
                <label>–ñ–∞–Ω—Ä:</label>
                <input type="text" id="genre" placeholder="RPG">
            </div>
            <div class="form-group">
                <label>–°—Ç–∞—Ç—É—Å:</label>
                <select id="status">
                    <option value="Backlog">–ü–ª–∞–Ω—É—é (Backlog)</option>
                    <option value="Playing">–ì—Ä–∞—é (Playing)</option>
                    <option value="Completed">–ü—Ä–æ–π—à–æ–≤ (Completed)</option>
                    <option value="Dropped">–ó–∞–∫–∏–Ω—É–≤ (Dropped)</option>
                </select>
            </div>
            <div class="form-group">
                <label>–†–µ–π—Ç–∏–Ω–≥ (0-10):</label>
                <input type="number" id="rating" min="0" max="10" step="0.5">
            </div>
            <div class="form-group">
                <label>–ö–æ–º–µ–Ω—Ç–∞—Ä:</label>
                <textarea id="comment" rows="3" placeholder="–í–∞—à—ñ –≤—Ä–∞–∂–µ–Ω–Ω—è..."></textarea>
            </div>

            <button class="btn btn-success" onclick="saveGame()">üíæ –ó–±–µ—Ä–µ–≥—Ç–∏</button>
            <button class="btn btn-secondary" onclick="showLibrary()">–°–∫–∞—Å—É–≤–∞—Ç–∏</button>
        </div>
    </div>

<script>
        // ‚ö†Ô∏è –í–ê–ñ–õ–ò–í–û: –ü–µ—Ä–µ–≤—ñ—Ä, —á–∏ —Ç—É—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–∏–π –ø–æ—Ä—Ç (—Ç–≤–æ—è –∫–æ–Ω—Å–æ–ª—å –ø–æ–∫–∞–∑—É–≤–∞–ª–∞ 5187 —É –ø–æ–º–∏–ª—Ü—ñ, —Ç–æ–º—É —è —Å—Ç–∞–≤–ª—é –π–æ–≥–æ)
        const API_URL = 'http://localhost:5187/api/Games'; 

        // --- –ù–ê–í–Ü–ì–ê–¶–Ü–Ø ---
        function showScreen(screenId) {
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            document.getElementById(screenId).classList.add('active');
        }
        function showMenu() { showScreen('menu-screen'); }
        
        // --- 1. READ (–ß–ò–¢–ê–ù–ù–Ø) ---
        async function showLibrary() {
            showScreen('library-screen');
            const listDiv = document.getElementById('games-list');
            listDiv.innerHTML = '<p>–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è...</p>';

            try {
                const response = await fetch(API_URL);
                const games = await response.json();

                listDiv.innerHTML = ''; // –û—á–∏—Å—Ç–∏—Ç–∏ —Å–ø–∏—Å–æ–∫
                
                if (games.length === 0) {
                    listDiv.innerHTML = '<p>–ë—ñ–±–ª—ñ–æ—Ç–µ–∫–∞ –ø—É—Å—Ç–∞. –î–æ–¥–∞–π –ø–µ—Ä—à—É –≥—Ä—É!</p>';
                    return;
                }

                games.forEach(game => {
                    const card = document.createElement('div');
                    card.className = 'game-card';
                    // –ó–≤–µ—Ä–Ω–∏ —É–≤–∞–≥—É: —è –¥–æ–¥–∞–≤ ' ' –Ω–∞–≤–∫–æ–ª–æ editGame, —â–æ–± JSON –Ω–µ –ª–∞–º–∞–≤—Å—è
                    card.innerHTML = `
                        <div class="game-info">
                            <h3>${game.title} <span class="status-badge">${game.status}</span></h3>
                            <p>üé≠ –ñ–∞–Ω—Ä: ${game.genre} | ‚≠ê ${game.rating}/10</p>
                            <p>üí¨ ${game.comment || '–ë–µ–∑ –∫–æ–º–µ–Ω—Ç–∞—Ä—ñ–≤'}</p>
                        </div>
                        <div class="game-actions">
                            <button class="btn btn-primary" onclick='editGame(${JSON.stringify(game)})'>‚úèÔ∏è</button>
                            <button class="btn btn-danger" onclick="deleteGame(${game.id})">üóëÔ∏è</button>
                        </div>
                    `;
                    listDiv.appendChild(card);
                });
            } catch (error) {
                listDiv.innerHTML = '<p style="color:red">–ü–æ–º–∏–ª–∫–∞ –∑\'—î–¥–Ω–∞–Ω–Ω—è –∑ —Å–µ—Ä–≤–µ—Ä–æ–º! –ü–µ—Ä–µ–≤—ñ—Ä –ø–æ—Ä—Ç.</p>';
                console.error(error);
            }
        }

        // --- 2. –ü–Ü–î–ì–û–¢–û–í–ö–ê –§–û–†–ú–ò ---
        function showAddForm() {
            document.getElementById('form-title').innerText = "–î–æ–¥–∞—Ç–∏ –Ω–æ–≤—É –≥—Ä—É";
            document.getElementById('game-id').value = ''; 
            document.getElementById('title').value = '';
            document.getElementById('genre').value = '';
            document.getElementById('status').value = 'Backlog';
            document.getElementById('rating').value = '';
            document.getElementById('comment').value = '';
            showScreen('form-screen');
        }

        function editGame(game) {
            document.getElementById('form-title').innerText = "–†–µ–¥–∞–≥—É–≤–∞—Ç–∏ –≥—Ä—É";
            document.getElementById('game-id').value = game.id;
            document.getElementById('title').value = game.title;
            document.getElementById('genre').value = game.genre;
            document.getElementById('status').value = game.status;
            document.getElementById('rating').value = game.rating;
            document.getElementById('comment').value = game.comment;
            showScreen('form-screen');
        }

        // --- 3. CREATE & UPDATE (–ó–ë–ï–†–ï–ñ–ï–ù–ù–Ø) ---
        async function saveGame() {
            const id = document.getElementById('game-id').value;
            
            const gameData = {
                id: id ? parseInt(id) : 0,
                title: document.getElementById('title').value,
                genre: document.getElementById('genre').value,
                status: document.getElementById('status').value,
                rating: parseFloat(document.getElementById('rating').value) || 0,
                comment: document.getElementById('comment').value
            };

            const method = id ? 'PUT' : 'POST';
            
            // üî• –û–°–¨ –¢–£–¢ –ë–£–õ–ê –ü–û–ú–ò–õ–ö–ê: –¢–µ–ø–µ—Ä –º–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ –∑–º—ñ–Ω–Ω—É API_URL
            const url = id ? `${API_URL}/${id}` : API_URL;

            try {
                const response = await fetch(url, {
                    method: method,
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(gameData)
                });

                if (response.ok) {
                    showLibrary(); 
                } else {
                    alert('–ü–æ–º–∏–ª–∫–∞ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è!');
                }
            } catch (error) {
                console.error(error);
                alert('–°–µ—Ä–≤–µ—Ä –Ω–µ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î.');
            }
        }

        // --- 4. DELETE (–í–ò–î–ê–õ–ï–ù–ù–Ø) ---
        async function deleteGame(id) {
            if (!confirm('–¢–æ—á–Ω–æ –≤–∏–¥–∞–ª–∏—Ç–∏ —Ü—é –≥—Ä—É?')) return;

            try {
                // üî• –Ü –¢–£–¢ –¢–ï–ñ: –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ –∑–º—ñ–Ω–Ω—É
                await fetch(`${API_URL}/${id}`, { method: 'DELETE' });
                showLibrary(); 
            } catch (error) {
                console.error(error);
                alert('–ù–µ –≤–¥–∞–ª–æ—Å—è –≤–∏–¥–∞–ª–∏—Ç–∏.');
            }
        }
    </script>
</body>
</html>